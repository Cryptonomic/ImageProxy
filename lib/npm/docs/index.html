<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>nft-image-proxy</title>
	<meta name="description" content="Documentation for nft-image-proxy">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">nft-image-proxy</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="modules.html">Globals</a>
				</li>
			</ul>
			<h1>Project nft-image-proxy</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#nft-image-proxy" id="nft-image-proxy" style="color: inherit; text-decoration: none;">
					<h1>NFT Image Proxy</h1>
				</a>
				<p><code>nft-image-proxy </code> is a javascript/typescript api to interact with <a href="https://github.com/Cryptonomic/ImageProxy">NFT Image Proxy</a> to allow for easy image filtering and moderation.</p>
				<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
					<h2>Installation</h2>
				</a>
				<p><code>nft-image-proxy</code> is available via npm. Run <code>npm install nft-image-proxy</code></p>
				<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
					<h2>Usage</h2>
				</a>
				<a href="#fetch" id="fetch" style="color: inherit; text-decoration: none;">
					<h3>Fetch</h3>
				</a>
				<p>To fetch an image, use <code>proxyFetch</code>. This function takes in a server object, the url to fetch, the response type (either <code>ImageProxyDataType.Json</code> or <code>ImageProxyDataType.Raw</code>), and a <code>force</code> flag. If <code>force</code> is set to true, the image will be fetched regardless of if it contains explicit content. If it is set to <code>false</code>, then explicit images will be blocked and a JSON response will be returned which contains a list of moderation labels that the image was found to match with.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #001080">proxyFetch</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">ImageProxyServer</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">ImageProxyDataType</span><span style="color: #000000">,</span>
<span style="color: #000000">} </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;nft-image-proxy&quot;</span><span style="color: #000000">;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">server</span><span style="color: #000000">: </span><span style="color: #267F99">ImageProxyServer</span><span style="color: #000000"> = {</span>
<span style="color: #000000">  </span><span style="color: #001080">url:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;https://imgproxy-prod.cryptonomic-infra.tech&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">version:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;1.0.0&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">apikey:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;myapikey&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">};</span>

<span style="color: #795E26">proxyFetch</span><span style="color: #000000">(</span>
<span style="color: #000000">  </span><span style="color: #001080">server</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #A31515">&quot;https://upload.wikimedia.org/wikipedia/commons/8/84/Michelangelo%27s_David_2015.jpg&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">ImageProxyDataType</span><span style="color: #000000">.</span><span style="color: #001080">Json</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #0000FF">false</span>
<span style="color: #000000">).</span><span style="color: #795E26">then</span><span style="color: #000000">((</span><span style="color: #001080">response</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">response</span><span style="color: #000000">));</span>
</code></pre>
				<p>Some convenience functions are also available. <code>safeFetch</code> is equivilant to <code>proxyFetch</code> with the force parameter set to <code>false</code> and <code>unsafeFetch</code> is equivilant to <code>proxyFetch</code> with the <code>force</code> parameter set to <code>true</code>.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">safeFetch</span><span style="color: #000000">, </span><span style="color: #001080">unsafeFetch</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;nft-image-proxy&quot;</span><span style="color: #000000">;</span>

<span style="color: #795E26">safeFetch</span><span style="color: #000000">(</span><span style="color: #001080">server</span><span style="color: #000000">, </span><span style="color: #001080">url</span><span style="color: #000000">, </span><span style="color: #001080">ImageProxyDataType</span><span style="color: #000000">.</span><span style="color: #001080">Json</span><span style="color: #000000">).</span><span style="color: #795E26">then</span><span style="color: #000000">(</span>
<span style="color: #000000">  (</span><span style="color: #001080">response</span><span style="color: #000000">: </span><span style="color: #267F99">FetchResponse</span><span style="color: #000000"> | </span><span style="color: #267F99">ImageProxyError</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">response</span><span style="color: #000000">)</span>
<span style="color: #000000">);</span>

<span style="color: #795E26">unsafeFetch</span><span style="color: #000000">(</span><span style="color: #001080">server</span><span style="color: #000000">, </span><span style="color: #001080">url</span><span style="color: #000000">, </span><span style="color: #001080">ImageProxyDataType</span><span style="color: #000000">.</span><span style="color: #001080">Json</span><span style="color: #000000">).</span><span style="color: #795E26">then</span><span style="color: #000000">(</span>
<span style="color: #000000">  (</span><span style="color: #001080">response</span><span style="color: #000000">: </span><span style="color: #267F99">FetchResponse</span><span style="color: #000000"> | </span><span style="color: #267F99">ImageProxyError</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">response</span><span style="color: #000000">)</span>
<span style="color: #000000">);</span>
</code></pre>
				<a href="#describe" id="describe" style="color: inherit; text-decoration: none;">
					<h3>Describe</h3>
				</a>
				<p>If the image proxy has seen an image previously, it can return moderation results from its cache before fetching. <code>describe</code> takes in an array of url strings and returns a JSON response containing a description of each image. The status of each image can be either <code>Blocked</code>, <code>Allowed</code>, or <code>NotSeen</code> (if the image hasn&#39;t been cached yet).</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">describe</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;nft-image-proxy&quot;</span><span style="color: #000000">;</span>

<span style="color: #795E26">describe</span><span style="color: #000000">(</span><span style="color: #001080">server</span><span style="color: #000000">, [</span><span style="color: #001080">url1</span><span style="color: #000000">, </span><span style="color: #001080">url2</span><span style="color: #000000">, </span><span style="color: #001080">url3</span><span style="color: #000000">]).</span><span style="color: #795E26">then</span><span style="color: #000000">(</span>
<span style="color: #000000">  (</span><span style="color: #001080">response</span><span style="color: #000000">: </span><span style="color: #267F99">DescribeResponse</span><span style="color: #000000"> | </span><span style="color: #267F99">ImageProxyError</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">response</span><span style="color: #000000">)</span>
<span style="color: #000000">);</span>
</code></pre>
				<a href="#report" id="report" style="color: inherit; text-decoration: none;">
					<h3>Report</h3>
				</a>
				<p>If an explicit image were to make it past the content moderation provider, a user could also report the image to the proxy with suggested moderation labels.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">response</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;nft-image-proxy&quot;</span><span style="color: #000000">;</span>

<span style="color: #795E26">report</span><span style="color: #000000">(</span><span style="color: #001080">server</span><span style="color: #000000">, </span><span style="color: #001080">url</span><span style="color: #000000">, [</span><span style="color: #001080">ModerationLabel</span><span style="color: #000000">.</span><span style="color: #001080">Drugs</span><span style="color: #000000">, </span><span style="color: #001080">ModerationLabel</span><span style="color: #000000">.</span><span style="color: #001080">Alcohol</span><span style="color: #000000">]).</span><span style="color: #795E26">then</span><span style="color: #000000">(</span>
<span style="color: #000000">  (</span><span style="color: #001080">response</span><span style="color: #000000">: </span><span style="color: #267F99">ReportResponse</span><span style="color: #000000"> | </span><span style="color: #267F99">ImageProxyError</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">response</span><span style="color: #000000">);</span>
<span style="color: #000000">  }</span>
<span style="color: #000000">);</span>
</code></pre>
				<a href="#describe-reports" id="describe-reports" style="color: inherit; text-decoration: none;">
					<h3>Describe Reports</h3>
				</a>
				<p>All of the current reports submitted to the image proxy can be viewed using <code>describeReports</code></p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">describeReports</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;nft-image-proxy&quot;</span><span style="color: #000000">;</span>

<span style="color: #795E26">describeReports</span><span style="color: #000000">(</span><span style="color: #001080">server</span><span style="color: #000000">).</span><span style="color: #795E26">then</span><span style="color: #000000">(</span>
<span style="color: #000000">  (</span><span style="color: #001080">response</span><span style="color: #000000">: </span><span style="color: #267F99">DescribeReportsResponse</span><span style="color: #000000"> | </span><span style="color: #267F99">ImageProxyError</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">response</span><span style="color: #000000">)</span>
<span style="color: #000000">);</span>
</code></pre>
				<a href="#other-references" id="other-references" style="color: inherit; text-decoration: none;">
					<h2>Other References</h2>
				</a>
				<p>For more information about the image proxy, the request and reponse formats, or how it works, view our public repo <a href="https://github.com/Cryptonomic/ImageProxy">here</a>.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Exports</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
					<li class=" tsd-kind-enum">
						<a href="enums/DocumentStatus.html" class="tsd-kind-icon">Document<wbr>Status</a>
					</li>
					<li class=" tsd-kind-enum">
						<a href="enums/ImageProxyDataType.html" class="tsd-kind-icon">Image<wbr>Proxy<wbr>Data<wbr>Type</a>
					</li>
					<li class=" tsd-kind-enum">
						<a href="enums/ImageProxyMethod.html" class="tsd-kind-icon">Image<wbr>Proxy<wbr>Method</a>
					</li>
					<li class=" tsd-kind-enum">
						<a href="enums/ModerationLabel.html" class="tsd-kind-icon">Moderation<wbr>Label</a>
					</li>
					<li class=" tsd-kind-enum">
						<a href="enums/ModerationStatus.html" class="tsd-kind-icon">Moderation<wbr>Status</a>
					</li>
					<li class=" tsd-kind-enum">
						<a href="enums/RpcStatus.html" class="tsd-kind-icon">Rpc<wbr>Status</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ImageProxyServer.html" class="tsd-kind-icon">Image<wbr>Proxy<wbr>Server</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#DescribeReportsRequest" class="tsd-kind-icon">Describe<wbr>Reports<wbr>Request</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#DescribeReportsResponse" class="tsd-kind-icon">Describe<wbr>Reports<wbr>Response</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#DescribeRequest" class="tsd-kind-icon">Describe<wbr>Request</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#DescribeResponse" class="tsd-kind-icon">Describe<wbr>Response</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#FetchRequest" class="tsd-kind-icon">Fetch<wbr>Request</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#FetchResponse" class="tsd-kind-icon">Fetch<wbr>Response</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#ImageProxyError" class="tsd-kind-icon">Image<wbr>Proxy<wbr>Error</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#ImageProxyRequest" class="tsd-kind-icon">Image<wbr>Proxy<wbr>Request</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#ImageProxyResponse" class="tsd-kind-icon">Image<wbr>Proxy<wbr>Response</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#ReportRequest" class="tsd-kind-icon">Report<wbr>Request</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#ReportResponse" class="tsd-kind-icon">Report<wbr>Response</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#describe" class="tsd-kind-icon">describe</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#describeReports" class="tsd-kind-icon">describe<wbr>Reports</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#proxyFetch" class="tsd-kind-icon">proxy<wbr>Fetch</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#report" class="tsd-kind-icon">report</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#safeFetch" class="tsd-kind-icon">safe<wbr>Fetch</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#unsafeFetch" class="tsd-kind-icon">unsafe<wbr>Fetch</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>